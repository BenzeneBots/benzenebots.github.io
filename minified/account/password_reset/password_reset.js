let params={};function confirmPass(){return document.getElementById("confirm_password").value!==document.getElementById("new_password").value?(document.getElementById("password-error").innerText="Passwords don't match",setInterval((()=>{document.getElementById("password-error").innerText=" "}),3e3),!1):(document.getElementById("password-error").innerText="",!0)}function checkExpire(){window.location.search.toString().replace("?","").split("&").forEach(((e,t)=>{if(e.toString().split("=")){let t=e.toString().split("=");params[t[0]]=t[1]}})),fetch(API_ROOT+`/temp/${params.sessionId}/expiration`,{method:"GET",headers:{id:localStorage.id,password:localStorage.password}}).then((e=>e.json())).then((e=>{console.log(e),e.expired&&!e.error||(window.location="localhost:232")}))}const addSubmitListener=()=>{document.forms[0].addEventListener("submit",(e=>{e.preventDefault()}))};async function handleFormSubmit(){if(confirmPass()){let e=document.getElementById("confirm_password").value,t=await new Promise(((t,o)=>crypto.subtle.digest("SHA-256",(new TextEncoder).encode(e)).then((e=>{t(Array.prototype.map.call(new Uint8Array(e),(e=>("00"+e.toString(16)).slice(-2))).join(""))})))),o={id:params.sessionId,password:t,userId:params.userId};fetch(API_ROOT+`/user/${params.userId}/resetpassword`,{method:"POST",headers:{"Content-Type":"application/json",id:localStorage.id,password:localStorage.password},body:JSON.stringify(o)}).then((e=>e.json())).then((e=>{e.success?window.location="/admin/":window.location="/"})).catch((e=>{M.toast({text:e.message})}))}else document.getElementById("password-error").innerText="Passwords don't match",setInterval((()=>{document.getElementById("password-error").innerText=" "}),3e3)}addSubmitListener(),setTimeout(addSubmitListener,1e3),setTimeout(addSubmitListener,3e3);